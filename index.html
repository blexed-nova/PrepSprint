<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PrepSprint Pro üöÄ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root { --primary: #1877f2; --bg: #f0f2f5; --card-bg: #ffffff; --text: #1c1e21; --success: #2ecc71; --danger: #e74c3c; }
        body.dark-mode { --bg: #18191a; --card-bg: #242526; --text: #e4e6eb; }
        body { font-family: 'Segoe UI', Arial, sans-serif; padding: 20px; background-color: var(--bg); color: var(--text); max-width: 850px; margin: auto; transition: 0.3s; }
        
        .container { background: var(--card-bg); padding: 30px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); position: relative; }
        
        /* HEADER & STATS */
        .header-stats { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: rgba(24, 119, 242, 0.1); padding: 15px; border-radius: 12px; }
        .user-rank { color: var(--primary); font-weight: bold; font-size: 1.1em; }
        .streak-fire { color: #ff9d00; font-weight: bold; }

        /* AUTH MODAL */
        #authOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 100; }
        .auth-box { background: var(--card-bg); padding: 40px; border-radius: 20px; text-align: center; width: 300px; }
        
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
        .actions { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        button { cursor: pointer; padding: 12px 20px; border: none; border-radius: 10px; background-color: var(--primary); color: white; font-weight: 600; transition: 0.2s; }
        
        #output { min-height: 220px; border: 2px dashed #cbd5e0; padding: 30px; border-radius: 15px; background: rgba(0,0,0,0.02); }
        .upload-section { margin-top: 20px; border-top: 1px solid #ddd; padding-top: 20px; text-align: center; }
        input[type="file"] { margin: 10px 0; }
    </style>
</head>
<body class="dark-mode"> <div id="authOverlay">
    <div class="auth-box">
        <h2>Welcome to PrepSprint</h2>
        <p>Create your profile to save progress</p>
        <input type="text" id="userName" placeholder="Your Name" style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ddd;">
        <button onclick="saveProfile()" style="width: 100%;">Start Sprinting üöÄ</button>
    </div>
</div>

<div class="container">
    <div class="header-stats">
        <div>
            <span id="displayName" class="user-rank">User</span> | 
            <span id="displayRank" style="color: var(--success);">Rookie</span>
        </div>
        <div>
            <span class="streak-fire">üî• <span id="streakCount">0</span> Days</span> | 
            <span style="font-weight: bold;">üèÜ <span id="scoreVal">0</span></span>
        </div>
    </div>

    <h1>PrepSprint Pro</h1>
    <div class="actions">
        <button onclick="showFlashcard()">üî• Flashcard</button>
        <button onclick="showMCQ()">üéØ MCQ</button>
        <button onclick="showTough()">üòà Tough Mode</button>
        <button onclick="toggleTheme()" style="background: #444;">üåì Theme</button>
    </div>

    <div id="output">
        <p style="text-align:center;">Practice to earn points and rank up!</p>
    </div>

    <div class="upload-section">
        <label>üß™ <strong>AI Question Lab (Phase 3 Beta)</strong></label><br>
        <small>Upload Notes/PDF for AI generation</small><br>
        <input type="file" id="pdfUpload" disabled>
        <button style="background: #8e44ad;" onclick="alert('In Phase 3, we connect the AI API here!')">Generate from File</button>
    </div>
</div>

<script>
    let user = { name: "", score: 0, streak: 0, lastDate: "", rank: "Rookie" };

    // --- INITIALIZE FROM STORAGE ---
    window.onload = function() {
        const saved = localStorage.getItem('prepsprint_user');
        if (saved) {
            user = JSON.parse(saved);
            document.getElementById('authOverlay').style.display = 'none';
            checkStreak();
            updateUI();
        }
    };

    function saveProfile() {
        const name = document.getElementById('userName').value;
        if (!name) return alert("Enter a name!");
        user.name = name;
        user.lastDate = new Date().toDateString();
        user.streak = 1;
        localStorage.setItem('prepsprint_user', JSON.stringify(user));
        document.getElementById('authOverlay').style.display = 'none';
        updateUI();
    }

    function checkStreak() {
        const today = new Date().toDateString();
        const yesterday = new Date(Date.now() - 86400000).toDateString();
        
        if (user.lastDate === yesterday) {
            user.streak++;
            user.lastDate = today;
        } else if (user.lastDate !== today) {
            user.streak = 1;
            user.lastDate = today;
        }
        saveData();
    }

    function updateUI() {
        document.getElementById('displayName').innerText = user.name;
        document.getElementById('scoreVal').innerText = user.score;
        document.getElementById('streakCount').innerText = user.streak;
        
        // Ranking Logic
        if (user.score > 500) user.rank = "Legend";
        else if (user.score > 200) user.rank = "Master";
        else if (user.score > 50) user.rank = "Scholar";
        document.getElementById('displayRank').innerText = user.rank;
    }

    function saveData() {
        localStorage.setItem('prepsprint_user', JSON.stringify(user));
        updateUI();
    }

    function updatePoints(pts) {
        user.score += pts;
        saveData();
    }

    function toggleTheme() { document.body.classList.toggle('dark-mode'); }

    // --- GAME LOGIC (Simplified for Demo) ---
    function showFlashcard() {
        document.getElementById("output").innerHTML = `
            <div style="text-align:center;">
                <h3>What is the 2nd Law of Thermodynamics?</h3>
                <button onclick="revealAns()">Show Answer</button>
            </div>`;
    }

    function revealAns() {
        document.getElementById("output").innerHTML += `
            <div class="answer-box">Entropy of an isolated system always increases. (+5 pts)</div>`;
        updatePoints(5);
    }

    function showMCQ() {
        document.getElementById("output").innerHTML = `<h3>MCQ: Which is a vector?</h3>
            <button onclick="correctMCQ()">Force</button> <button onclick="wrongMCQ()">Mass</button>`;
    }

    function correctMCQ() {
        document.getElementById("output").innerHTML = "<h2 style='color:var(--success)'>‚úÖ +10 Points!</h2>";
        updatePoints(10);
    }
    
    function wrongMCQ() { alert("Wrong! Try again."); }

    function showTough() {
        document.getElementById("output").innerHTML = "<h3>üòà Tough Mode</h3><p>Calculate V if I=2A, R=10Œ©</p><input id='ans' type='number'><button onclick='checkT(20)'>Submit</button>";
    }

    function checkT(c) {
        if(parseInt(document.getElementById('ans').value) === c) {
            updatePoints(50);
            document.getElementById("output").innerHTML = "<h2>‚úÖ LEGEND! +50 Pts</h2>";
        }
    }
</script>
</body>
</html>
